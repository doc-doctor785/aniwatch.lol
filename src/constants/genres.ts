export const ANIME_GENRES = [
  'Боевые искусства',
  'Военное',
  'Драма',
  'Детектив',
  'Комедия',
  'Меха',
  'Мистика',
  'Повседневность',
  'Приключения',
  'Романтика',
  'Сверхъестественное',
  'Спорт',
  'Сёнен',
  'Триллер',
  'Ужасы',
  'Фантастика',
  'Фэнтези',
  'Школа',
] as const;

export type AnimeGenre = typeof ANIME_GENRES[number];

export function normalizeGenre(genre: string): AnimeGenre | null {
  const normalizedGenre = genre.trim();
  
  // Проверяем точное совпадение
  if (ANIME_GENRES.includes(normalizedGenre as AnimeGenre)) {
    return normalizedGenre as AnimeGenre;
  }
  
  const lowercaseGenre = normalizedGenre.toLowerCase();
  
  // Карта соответствия различных написаний жанров
  const genreMap: Record<string, AnimeGenre> = {
    // Боевые искусства
    'боевые искусства': 'Боевые искусства',
    'martial arts': 'Боевые искусства',
    'боевик': 'Боевые искусства',
    'боевые': 'Боевые искусства',
    'единоборства': 'Боевые искусства',
    'action': 'Боевые искусства',
    
    // Военное
    'война': 'Военное',
    'military': 'Военное',
    'военный': 'Военное',
    'милитари': 'Военное',
    'military action': 'Военное',
    'war': 'Военное',
    
    // Драма
    'drama': 'Драма',
    'драмма': 'Драма',
    'драматический': 'Драма',
    'психологическая драма': 'Драма',
    
    // Детектив
    'detective': 'Детектив',
    'детективы': 'Детектив',
    'детективный': 'Детектив',
    'mystery': 'Детектив',
    'расследование': 'Детектив',
    
    // Комедия
    'comedy': 'Комедия',
    'комедийный': 'Комедия',
    'юмор': 'Комедия',
    'ситком': 'Комедия',
    'комедийная драма': 'Комедия',
    
    // Меха
    'mecha': 'Меха',
    'меха': 'Меха',
    'механика': 'Меха',
    'роботы': 'Меха',
    'robots': 'Меха',
    
    // Мистика
    'мистика': 'Мистика',
    'мистический': 'Мистика',
    'mystic': 'Мистика',
    'mystical': 'Мистика',
    'таинственный': 'Мистика',
    'spiritual': 'Мистика',
    
    // Повседневность
    'slice of life': 'Повседневность',
    'повседневный': 'Повседневность',
    'бытовое': 'Повседневность',
    'повседневная жизнь': 'Повседневность',
    'повседневность': 'Повседневность',
    'быт': 'Повседневность',
    'daily life': 'Повседневность',
    
    // Приключения
    'adventure': 'Приключения',
    'приключенческий': 'Приключения',
    'приключение': 'Приключения',
    'adventures': 'Приключения',
    'quest': 'Приключения',
    
    // Романтика
    'romance': 'Романтика',
    'романтический': 'Романтика',
    'романтика': 'Романтика',
    'love story': 'Романтика',
    'любовный': 'Романтика',
    'любовь': 'Романтика',
    
    // Сверхъестественное
    'supernatural': 'Сверхъестественное',
    'сверхъестественный': 'Сверхъестественное',
    'паранормальное': 'Сверхъестественное',
    'paranormal': 'Сверхъестественное',
    'occult': 'Сверхъестественное',
    
    // Спорт
    'sports': 'Спорт',
    'спортивный': 'Спорт',
    'sport': 'Спорт',
    'sporting': 'Спорт',
    'athletic': 'Спорт',
    'спортивная': 'Спорт',
    
    // Сёнен
    'shounen': 'Сёнен',
    'сёнэн': 'Сёнен',
    'сенен': 'Сёнен',
    'shonen': 'Сёнен',
    'сёнен': 'Сёнен',
    'сенэн': 'Сёнен',
    
    // Триллер
    'thriller': 'Триллер',
    'триллеры': 'Триллер',
    'psychological': 'Триллер',
    'психологический': 'Триллер',
    'саспенс': 'Триллер',
    'suspense': 'Триллер',
    
    // Ужасы
    'horror': 'Ужасы',
    'хоррор': 'Ужасы',
    'ужастик': 'Ужасы',
    'страшное': 'Ужасы',
    'страшилка': 'Ужасы',
    'gore': 'Ужасы',
    
    // Фантастика
    'sci-fi': 'Фантастика',
    'science fiction': 'Фантастика',
    'фантастический': 'Фантастика',
    'научная фантастика': 'Фантастика',
    'scientific': 'Фантастика',
    
    // Фэнтези
    'fantasy': 'Фэнтези',
    'фэнтези': 'Фэнтези',
    'фентези': 'Фэнтези',
    'сказочный': 'Фэнтези',
    'магический': 'Фэнтези',
    'магия': 'Фэнтези',
    'сказка': 'Фэнтези',
    
    // Школа
    'school': 'Школа',
    'школьный': 'Школа',
    'школьная жизнь': 'Школа',
    'академия': 'Школа',
    'academy': 'Школа',
    'school life': 'Школа',
    'campus': 'Школа'
  };

  // Пробуем найти точное соответствие в карте
  if (genreMap[lowercaseGenre]) {
    return genreMap[lowercaseGenre];
  }

  // Если точного соответствия нет, ищем частичное совпадение
  for (const [key, value] of Object.entries(genreMap)) {
    if (lowercaseGenre.includes(key) || key.includes(lowercaseGenre)) {
      return value;
    }
  }

  console.log('Не удалось нормализовать жанр:', normalizedGenre);
  return null;
}
